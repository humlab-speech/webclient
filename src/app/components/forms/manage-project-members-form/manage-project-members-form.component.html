<div [formGroup]="form">
    <!--
    <div *ngIf="loadingStatus" class="session-loading-indicator-container">
        <img src="../../../assets/loading-indicator-4-dark.svg">
        Loading project data: {{ loadingMessage }}
    </div>
    -->

    <h3>Members</h3>
        <div *ngIf="userIsProjectMaintainer()" class="form-control-pair-container">
            <div (click)="toggleMemberSearch()" class="form-control-pair-label">
                <i class="fa fa-plus-circle" aria-hidden="true"></i>
                &nbsp;
                Add member
            </div>
            <div id="search-user-input" class="form-control-pair-input">
                <label>Search user:&nbsp;</label>
                <div>
                    <input type="text" id="search-user-control" (keyup)="searchUser($event)"/>
                    <div id="user-select-options">
                        <ul class="select-search-results-list" *ngFor="let searchUser of searchUsers">
                            <li (click)="addMember(searchUser)" class="search-option-user-container">
                                <img src="{{searchUser.avatar_url}}" class="avatar_image" />
                                {{searchUser.name}}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <br />
        </div>

        
        
        
        <ul *ngFor="let member of projectMemberForms.controls">
            <li>
                <details>
                    <summary>
                        <img src="{{member.controls.member.value.avatar_url}}" class="avatar_image" /> {{member.controls.member.value.name}}
                        <span *ngIf="member.controls.member.value.id == project.owner.id"> | project owner</span>
                    </summary>
                    
                    <div>
                        
                        <div class="bundle-container">
                            <h5>Assigned bundles</h5>
                            <ul *ngFor="let session of member.controls.sessions.controls">

                                <div *ngFor="let bundle of session.value.bundles">
                                    <li class="bundle-li">
                                        <input id="{{member.controls.member.value.username}}-{{session.value.sessionName}}-{{bundle.bundleName}}" [checked]="memberHasBundle(member.value.member.username, session.value.sessionName, bundle.bundleName)" (click)="bundleClicked(member.value.member.username, session.value.sessionName, bundle.bundleName, $event)" type="checkbox" />
                                        <label for="{{member.controls.member.value.username}}-{{session.value.sessionName}}-{{bundle.bundleName}}">&nbsp;{{session.value.sessionName}} | {{bundle.bundleName}}</label>
                                    </li>
                                </div>
                                
                            </ul>
                        </div>

                        <div *ngIf="member.controls.member.value.id != project.owner.id && userIsProjectMaintainer()" class="remove-button-container">
                            <div (click)="removeMember(member.controls.member.value)" class="list-button remove-member-button">
                                <div>
                                    <i class="fa fa-times" aria-hidden="true"></i> Remove member
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </details>
                
            </li>
        </ul>
        
        <br />
        <button id="member-form-save-button" [ngClass]="{'disabled': !submitBtnEnabled}" [disabled]="!submitBtnEnabled" (click)="saveForm()">
            <img *ngIf="showLoadingIndicator" src="../../../../assets/loading-indicator-4-light.svg">
            <i *ngIf="!showLoadingIndicator" class="fa fa-save" aria-hidden="true"></i>
            &nbsp;
            {{ submitBtnLabel }}
        </button>

</div>